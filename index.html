<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meteoriten-Spiel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000;
            color: #FFF;
            margin: 0;
            overflow: hidden;
        }
        h1 {
            text-align: center;
            margin-top: 20px;
        }
        #game-container {
            position: relative;
            width: 100%;
            height: 80vh;
            background-color: #2C3E50;
            overflow: hidden;
        }
        .meteor {
            position: absolute;
            width: 50px;
            height: 50px;
            background-image: url('https://i.imgur.com/nsqaual.jpeg');
            background-size: cover;
            animation: fall linear 3s;
        }
        @keyframes fall {
            0% { top: -50px; }
            100% { top: 100%; }
        }
        #control-panel {
            text-align: center;
            margin-top: 20px;
        }
        .input-field, .btn {
            padding: 10px;
            font-size: 1em;
            margin: 5px;
            border: none;
            border-radius: 5px;
        }
        .btn {
            background-color: #27AE60;
            color: white;
            cursor: pointer;
        }
        .btn:hover {
            background-color: #2ECC71;
        }
        #gameover-screen {
            display: none;
            text-align: center;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Meteoriten-Spiel</h1>
    <div id="game-container"></div>
    <div id="control-panel">
        <input type="number" id="guess" class="input-field" placeholder="Errate die Zahl (1-12)" min="1" max="12">
        <button class="btn" onclick="checkGuess()">Bestätigen</button>
        <input type="text" id="secret-code" class="input-field" placeholder="Geheimer Code">
        <button class="btn" onclick="useSecretCode()">Code verwenden</button>
        <p id="feedback"></p>
        <p>Punkte: <span id="score">0</span></p>
    </div>
    <div id="gameover-screen" class="hidden">
        <h2>Game Over!</h2>
        <p id="final-score"></p>
        <p id="rating"></p>
        <button class="btn" onclick="restartGame()">Try Again</button>
    </div>

    <script>
        let score = 0;
        let round = 0;
        let gameOver = false;
        let allowlist = false;
        let showAlways = false;
        let secretUsed = {
            "AboFluesterer": false,
            "G O D": false,
            "showall": false
        };
        let meteorInterval;

        function startGame() {
            spawnMeteor();
            meteorInterval = setInterval(spawnMeteor, 3000);
        }

        function spawnMeteor() {
            const container = document.getElementById('game-container');
            const meteor = document.createElement('div');
            meteor.classList.add('meteor');
            const targetNumber = Math.floor(Math.random() * 12) + 1;
            meteor.dataset.target = targetNumber;
            meteor.style.left = `${Math.random() * 90}%`;
            container.appendChild(meteor);

            setTimeout(() => {
                container.removeChild(meteor);
                if (!gameOver) checkMiss(targetNumber);
            }, 3000);
        }

        function checkGuess() {
            if (gameOver) return;
            const guess = parseInt(document.getElementById('guess').value);
            const meteors = document.querySelectorAll('.meteor');

            let hit = false;
            meteors.forEach(meteor => {
                if (parseInt(meteor.dataset.target) === guess) {
                    hit = true;
                    meteor.remove();
                }
            });

            if (hit || showAlways) {
                score += 10;
                round++;
                document.getElementById('feedback').textContent = "Richtig geraten!";
            } else {
                document.getElementById('feedback').textContent = "Falsch geraten! Game Over!";
                endGame();
            }

            document.getElementById('score').textContent = score;
        }

        function checkMiss(targetNumber) {
            if (!showAlways) {
                document.getElementById('feedback').textContent = `Der Meteorit hat die Zahl ${targetNumber} getroffen.`;
                endGame();
            }
        }

        function endGame() {
            gameOver = true;
            clearInterval(meteorInterval);
            document.getElementById('control-panel').classList.add('hidden');
            document.getElementById('gameover-screen').classList.remove('hidden');
            document.getElementById('final-score').textContent = `Punkte: ${score}`;
            document.getElementById('rating').textContent = `Bewertung: ${getRating()}`;
        }

        function getRating() {
            if (round >= 5) return "A+";
            if (round >= 4) return "A";
            if (round >= 3) return "B";
            if (round >= 2) return "C";
            if (round >= 1) return "D";
            return "F-";
        }

        function restartGame() {
            score = 0;
            round = 0;
            gameOver = false;
            document.getElementById('control-panel').classList.remove('hidden');
            document.getElementById('gameover-screen').classList.add('hidden');
            document.getElementById('score').textContent = score;
            startGame();
        }

        function useSecretCode() {
            const code = document.getElementById('secret-code').value.trim();

            if (code === "allowlistaddFluesterer") {
                allowlist = true;
                document.getElementById('feedback').textContent = "Du bist jetzt auf der Allowlist!";
                return;
            }

            if (code === "showall" && allowlist) {
                showAlways = true;
                document.getElementById('feedback').textContent = "Geheimer Modus aktiviert: Zahlen werden immer angezeigt.";
                return;
            }

            if (code === "AboFluesterer" && !secretUsed["AboFluesterer"]) {
                secretUsed["AboFluesterer"] = true;
                document.getElementById('feedback').textContent = "Die nächste Zahl ist garantiert richtig!";
                showAlways = true;
                return;
            }

            document.getElementById('feedback').textContent = "Dieser Code existiert nicht oder wurde bereits verwendet!";
        }

        startGame();
    </script>
</body>
</html>
